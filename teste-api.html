<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de API - Sistema de Doa√ß√µes</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .info {
            background-color: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        pre {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Teste de API - Sistema de Doa√ß√µes</h1>
        
        <div class="test-section info">
            <h3>üìã Status da Conex√£o</h3>
            <p><strong>API Base:</strong> https://ajudaongs.up.railway.app/api</p>
            <p><strong>Status:</strong> <span id="connection-status">Testando...</span></p>
        </div>

        <div class="test-section">
            <h3>üë• Teste de Doadores</h3>
            <button onclick="testarDoadores()">Listar Doadores</button>
            <button onclick="criarDoador()">Criar Doador de Teste</button>
        <button onclick="criarMultiplosDoadores()">Criar M√∫ltiplos Doadores</button>
            <div id="doadores-result"></div>
        </div>

        <div class="test-section">
            <h3>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Teste de Fam√≠lias</h3>
            <button onclick="testarFamilias()">Listar Fam√≠lias</button>
            <button onclick="criarFamilia()">Criar Fam√≠lia de Teste</button>
        <button onclick="criarMultiplasFamilias()">Criar M√∫ltiplas Fam√≠lias</button>
            <div id="familias-result"></div>
        </div>

        <div class="test-section">
            <h3>üì¶ Teste de Produtos</h3>
            <button onclick="testarProdutos()">Listar Produtos</button>
            <button onclick="criarProduto()">Criar Produto de Teste</button>
            <div id="produtos-result"></div>
        </div>

        <div class="test-section">
            <h3>üéÅ Teste de Doa√ß√µes</h3>
            <button onclick="testarDoacoes()">Listar Doa√ß√µes</button>
            <button onclick="testarDoacoesFamilias()">Listar Doa√ß√µes para Fam√≠lias</button>
            <button onclick="criarDoacao()">Criar Doa√ß√£o de Teste</button>
            <div id="doacoes-result"></div>
        </div>

        <div class="test-section">
            <h3>üè† Teste de Doa√ß√µes para Fam√≠lias</h3>
            <button onclick="testarDoacoesFamilias()">Listar Doa√ß√µes para Fam√≠lias</button>
            <button onclick="criarDoacaoFamiliaAleatoria()">Criar Doa√ß√£o Aleat√≥ria para Fam√≠lia</button>
        <button onclick="criarMultiplasDoacoes()">Criar M√∫ltiplas Doa√ß√µes (Teste)</button>
            <div id="doacoes-familias-result"></div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'https://ajudaongs.up.railway.app/api';
        
        // Teste inicial de conex√£o
        async function testarConexao() {
            try {
                const response = await axios.get(`${API_BASE_URL}/doadores`);
                document.getElementById('connection-status').innerHTML = 
                    '<span style="color: green;">‚úÖ Conectado com sucesso!</span>';
            } catch (error) {
                document.getElementById('connection-status').innerHTML = 
                    '<span style="color: red;">‚ùå Erro de conex√£o: ' + error.message + '</span>';
            }
        }

        // Teste de doadores
        async function testarDoadores() {
            const resultDiv = document.getElementById('doadores-result');
            resultDiv.innerHTML = '<p>Carregando...</p>';
            
            try {
                const response = await axios.get(`${API_BASE_URL}/doadores`);
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Doadores carregados com sucesso!</h4>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao carregar doadores</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Criar doador de teste
        function gerarEmailAleatorio() {
            const prefixo = Math.random().toString(36).substring(2, 10);
            return `usuario${prefixo}@email.com`;
        }

        async function criarDoador() {
            const resultDiv = document.getElementById('doadores-result');
            resultDiv.innerHTML = '<p>Criando doador...</p>';
            
            // Lista de nomes brasileiros para gerar dados mais realistas
            const nomes = [
                "Ana Silva", "Carlos Santos", "Maria Oliveira", "Jo√£o Pereira", "Lucia Costa",
                "Pedro Ferreira", "Fernanda Lima", "Roberto Almeida", "Patricia Souza", "Marcos Rodrigues",
                "Juliana Barbosa", "Ricardo Gomes", "Camila Martins", "Andre Silva", "Vanessa Santos",
                "Felipe Oliveira", "Gabriela Costa", "Thiago Pereira", "Isabela Lima", "Rafael Almeida",
                "Carolina Souza", "Diego Rodrigues", "Amanda Barbosa", "Lucas Gomes", "Mariana Martins",
                "Bruno Silva", "Beatriz Santos", "Guilherme Oliveira", "Larissa Costa", "Matheus Pereira"
            ];
            
            const sobrenomes = [
                "Silva", "Santos", "Oliveira", "Souza", "Rodrigues", "Ferreira", "Almeida", "Pereira",
                "Lima", "Gomes", "Costa", "Ribeiro", "Martins", "Carvalho", "Alves", "Lopes", "Soares",
                "Fernandes", "Vieira", "Barbosa", "Rocha", "Dias", "Nascimento", "Andrade", "Moreira"
            ];
            
            // Gerar nome aleat√≥rio
            const nomeAleatorio = nomes[Math.floor(Math.random() * nomes.length)];
            const sobrenomeAleatorio = sobrenomes[Math.floor(Math.random() * sobrenomes.length)];
            const nomeCompleto = `${nomeAleatorio} ${sobrenomeAleatorio}`;
            
            // Gerar endere√ßo aleat√≥rio
            const ruas = ["Rua das Flores", "Avenida Principal", "Rua do Com√©rcio", "Avenida Central", "Rua da Paz"];
            const numero = Math.floor(Math.random() * 999) + 1;
            const ruaAleatoria = ruas[Math.floor(Math.random() * ruas.length)];
            
            try {
                const doadorData = {
                    nome: nomeCompleto,
                    email: gerarEmailAleatorio(),
                    telefone: `(11) ${Math.floor(Math.random() * 90000) + 10000}-${Math.floor(Math.random() * 9000) + 1000}`,
                    endereco: `${ruaAleatoria}, ${numero}`
                };
                
                const response = await axios.post(`${API_BASE_URL}/doadores`, doadorData, {
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    }
                });
                
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Doador criado com sucesso!</h4>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao criar doador</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Teste de fam√≠lias
        async function testarFamilias() {
            const resultDiv = document.getElementById('familias-result');
            resultDiv.innerHTML = '<p>Carregando...</p>';
            
            try {
                const response = await axios.get(`${API_BASE_URL}/familias`);
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Fam√≠lias carregadas com sucesso!</h4>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao carregar fam√≠lias</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Criar fam√≠lia de teste
        async function criarFamilia() {
            const resultDiv = document.getElementById('familias-result');
            resultDiv.innerHTML = '<p>Criando fam√≠lia...</p>';
            
            function gerarCpfAleatorio() {
                let cpf = '';
                for (let i = 0; i < 11; i++) {
                    cpf += Math.floor(Math.random() * 10);
                }
                // Formata como 000.000.000-00
                return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4");
            }

            // Lista de nomes brasileiros para fam√≠lias
            const nomesFamilia = [
                "Maria Silva", "Jos√© Santos", "Ana Oliveira", "Carlos Pereira", "Lucia Costa",
                "Pedro Ferreira", "Fernanda Lima", "Roberto Almeida", "Patricia Souza", "Marcos Rodrigues",
                "Juliana Barbosa", "Ricardo Gomes", "Camila Martins", "Andre Silva", "Vanessa Santos",
                "Felipe Oliveira", "Gabriela Costa", "Thiago Pereira", "Isabela Lima", "Rafael Almeida",
                "Carolina Souza", "Diego Rodrigues", "Amanda Barbosa", "Lucas Gomes", "Mariana Martins",
                "Bruno Silva", "Beatriz Santos", "Guilherme Oliveira", "Larissa Costa", "Matheus Pereira"
            ];
            
            const sobrenomesFamilia = [
                "Silva", "Santos", "Oliveira", "Souza", "Rodrigues", "Ferreira", "Almeida", "Pereira",
                "Lima", "Gomes", "Costa", "Ribeiro", "Martins", "Carvalho", "Alves", "Lopes", "Soares",
                "Fernandes", "Vieira", "Barbosa", "Rocha", "Dias", "Nascimento", "Andrade", "Moreira"
            ];
            
            // Gerar nome aleat√≥rio para fam√≠lia
            const nomeAleatorio = nomesFamilia[Math.floor(Math.random() * nomesFamilia.length)];
            const sobrenomeAleatorio = sobrenomesFamilia[Math.floor(Math.random() * sobrenomesFamilia.length)];
            const nomeCompleto = `${nomeAleatorio} ${sobrenomeAleatorio}`;
            
            // Gerar endere√ßo aleat√≥rio
            const ruas = ["Rua das Fam√≠lias", "Avenida da Esperan√ßa", "Rua da Solidariedade", "Avenida da Paz", "Rua da Uni√£o"];
            const numero = Math.floor(Math.random() * 999) + 1;
            const ruaAleatoria = ruas[Math.floor(Math.random() * ruas.length)];

            try {
                const familiaData = {
                    nome_representante: nomeCompleto,
                    cpf_responsavel: gerarCpfAleatorio(),
                    telefone: `(11) ${Math.floor(Math.random() * 90000) + 10000}-${Math.floor(Math.random() * 9000) + 1000}`,
                    endereco: `${ruaAleatoria}, ${numero}`
                };
                
                const response = await axios.post(`${API_BASE_URL}/familias`, familiaData, {
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    }
                });
                
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Fam√≠lia criada com sucesso!</h4>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao criar fam√≠lia</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Teste de produtos
        async function testarProdutos() {
            const resultDiv = document.getElementById('produtos-result');
            resultDiv.innerHTML = '<p>Carregando...</p>';
            
            try {
                const response = await axios.get(`${API_BASE_URL}/produtos`);
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Produtos carregados com sucesso!</h4>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao carregar produtos</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Teste de doa√ß√µes
        async function testarDoacoes() {
            const resultDiv = document.getElementById('doacoes-result');
            resultDiv.innerHTML = '<p>Carregando...</p>';
            
            try {
                const response = await axios.get(`${API_BASE_URL}/doacoes`);
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Doa√ß√µes carregadas com sucesso!</h4>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao carregar doa√ß√µes</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Teste de doa√ß√µes para fam√≠lias
        async function testarDoacoesFamilias() {
            const resultDiv = document.getElementById('doacoes-familias-result');
            resultDiv.innerHTML = '<p>Carregando...</p>';
            
            try {
                const response = await axios.get(`${API_BASE_URL}/doacao-familia`);
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Doa√ß√µes para fam√≠lias carregadas com sucesso!</h4>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao carregar doa√ß√µes para fam√≠lias</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Criar doa√ß√£o aleat√≥ria para fam√≠lia
        async function criarDoacaoFamiliaAleatoria() {
            const resultDiv = document.getElementById('doacoes-familias-result');
            resultDiv.innerHTML = '<p>Criando doa√ß√£o aleat√≥ria para fam√≠lia...</p>';
            
            try {
                // Buscar fam√≠lias existentes
                const familiasResp = await axios.get(`${API_BASE_URL}/familias`);
                const familias = familiasResp.data.data;
                if (!familias.length) {
                    throw new Error('Cadastre uma fam√≠lia primeiro!');
                }
                
                // Buscar produtos dispon√≠veis
                const produtosResp = await axios.get(`${API_BASE_URL}/produtos`);
                const produtos = produtosResp.data.data;
                if (!produtos.length) {
                    throw new Error('Cadastre produtos primeiro!');
                }
                
                // Selecionar fam√≠lia e produto aleat√≥rios
                const familiaAleatoria = familias[Math.floor(Math.random() * familias.length)];
                const produtoAleatorio = produtos[Math.floor(Math.random() * produtos.length)];
                
                // Gerar quantidade aleat√≥ria entre 1 e 5
                const quantidadeAleatoria = Math.floor(Math.random() * 5) + 1;
                
                // Gerar data aleat√≥ria nos √∫ltimos 30 dias
                const dataAleatoria = new Date();
                dataAleatoria.setDate(dataAleatoria.getDate() - Math.floor(Math.random() * 30));
                
                const doacaoFamiliaData = {
                    familia_id_familia: familiaAleatoria.id,
                    produtos_id: produtoAleatorio.id,
                    quantidade: quantidadeAleatoria,
                    data: dataAleatoria.toISOString().slice(0, 10)
                };
                
                // Removido log detalhado para evitar vazamento de dados em produ√ß√£o
                
                const response = await axios.post(`${API_BASE_URL}/doacao-familia`, doacaoFamiliaData, {
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    }
                });
                
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Doa√ß√£o aleat√≥ria para fam√≠lia criada com sucesso!</h4>
                        <p><strong>Fam√≠lia:</strong> ${familiaAleatoria.nome_representante} (ID: ${familiaAleatoria.id})</p>
                        <p><strong>Produto:</strong> ${produtoAleatorio.nome} (ID: ${produtoAleatorio.id})</p>
                        <p><strong>Quantidade:</strong> ${quantidadeAleatoria}</p>
                        <p><strong>Data:</strong> ${dataAleatoria.toISOString().slice(0, 10)}</p>
                        <p><strong>Total de fam√≠lias dispon√≠veis:</strong> ${familias.length}</p>
                        <p><strong>Total de produtos dispon√≠veis:</strong> ${produtos.length}</p>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao criar doa√ß√£o para fam√≠lia</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Fun√ß√£o para gerar nome de produto aleat√≥rio
        function gerarNomeProdutoAleatorio() {
            const nomes = [
                "Arroz", "Feij√£o", "Macarr√£o", "√ìleo", "A√ß√∫car", "Sal", "Caf√©", "Leite", "Farinha", "Biscoito",
                "Azeite", "Molho de Tomate", "Milho", "Ervilha", "Atum", "Sardinha", "Manteiga", "Queijo",
                "Iogurte", "P√£o", "Bolacha", "Chocolate", "Refrigerante", "Suco", "√Ågua", "Sab√£o", "Detergente",
                "Papel Higi√™nico", "Fralda", "Shampoo", "Creme Dental", "Escova de Dentes", "Toalha", "Len√ßol"
            ];
            const marcas = ["Premium", "Especial", "Fino", "Sele√ß√£o", "Qualidade", "Nobre", "Supremo", "Extra"];
            const marca = marcas[Math.floor(Math.random() * marcas.length)];
            const nome = nomes[Math.floor(Math.random() * nomes.length)];
            return `${nome} ${marca}`;
        }

        // Fun√ß√£o para criar produto de teste
        async function criarProduto() {
            const resultDiv = document.getElementById('produtos-result');
            resultDiv.innerHTML = '<p>Criando produto (via doa√ß√£o)...</p>';
            try {
                // Buscar um doador existente para vincular a doa√ß√£o
                const doadoresResp = await axios.get(`${API_BASE_URL}/doadores`);
                const doadores = doadoresResp.data.data;
                if (!doadores.length) throw new Error('Cadastre um doador primeiro!');
                // Selecionar doador aleat√≥rio ao inv√©s de sempre o primeiro
                const doador = doadores[Math.floor(Math.random() * doadores.length)];

                const produto = {
                    nome: gerarNomeProdutoAleatorio(),
                    unidade: Math.floor(Math.random() * 10) + 1,
                    validade: '2025-12-31',
                    descricao: 'Produto de teste gerado automaticamente',
                    data: new Date().toISOString().slice(0, 10)
                };

                const doacaoData = {
                    data_doacao: new Date().toISOString().slice(0, 10),
                    data_entrada: new Date().toISOString().slice(0, 10),
                    data_entrega: null,
                    id_doador: doador.id,
                    produtos: [produto]
                };

                const response = await axios.post(`${API_BASE_URL}/doacoes`, doacaoData, {
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    }
                });

                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Produto (via doa√ß√£o) criado com sucesso!</h4>
                        <p><strong>Doador utilizado:</strong> ${doador.nome} (ID: ${doador.id})</p>
                        <p><strong>Produto criado:</strong> ${produto.nome}</p>
                        <p><strong>Total de doadores dispon√≠veis:</strong> ${doadores.length}</p>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao criar produto</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Fun√ß√£o para criar doa√ß√£o de teste
        async function criarDoacao() {
            const resultDiv = document.getElementById('doacoes-result');
            resultDiv.innerHTML = '<p>Criando doa√ß√£o...</p>';
            try {
                // Buscar um doador existente
                const doadoresResp = await axios.get(`${API_BASE_URL}/doadores`);
                const doadores = doadoresResp.data.data;
                if (!doadores.length) throw new Error('Cadastre um doador primeiro!');
                // Selecionar doador aleat√≥rio ao inv√©s de sempre o primeiro
                const doador = doadores[Math.floor(Math.random() * doadores.length)];
                // Buscar produtos existentes
                const produtosResp = await axios.get(`${API_BASE_URL}/produtos`);
                const produtos = produtosResp.data.data;
                if (!produtos.length) throw new Error('Cadastre um produto primeiro!');
                // Seleciona at√© 2 produtos aleat√≥rios
                const produtosSelecionados = produtos.sort(() => 0.5 - Math.random()).slice(0, 2).map(prod => ({
                    nome: prod.nome,
                    unidade: prod.unidade,
                    validade: prod.validade,
                    descricao: prod.descricao,
                    data: prod.data
                }));
                const doacaoData = {
                    data_doacao: new Date().toISOString().slice(0, 10),
                    data_entrada: new Date().toISOString().slice(0, 10),
                    data_entrega: null,
                    id_doador: doador.id,
                    produtos: produtosSelecionados
                };
                const response = await axios.post(`${API_BASE_URL}/doacoes`, doacaoData, {
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    }
                });
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Doa√ß√£o criada com sucesso!</h4>
                        <p><strong>Doador utilizado:</strong> ${doador.nome} (ID: ${doador.id})</p>
                        <p><strong>Produtos inclu√≠dos:</strong> ${produtosSelecionados.length}</p>
                        <p><strong>Total de doadores dispon√≠veis:</strong> ${doadores.length}</p>
                        <p><strong>Total de produtos dispon√≠veis:</strong> ${produtos.length}</p>
                        <pre>${JSON.stringify(response.data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao criar doa√ß√£o</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Fun√ß√£o para criar m√∫ltiplas doa√ß√µes de teste
        async function criarMultiplasDoacoes() {
            const resultDiv = document.getElementById('doacoes-familias-result');
            resultDiv.innerHTML = '<p>Criando m√∫ltiplas doa√ß√µes de teste...</p>';
            
            try {
                // Buscar dados existentes
                const [doadoresResp, produtosResp, familiasResp] = await Promise.all([
                    axios.get(`${API_BASE_URL}/doadores`),
                    axios.get(`${API_BASE_URL}/produtos`),
                    axios.get(`${API_BASE_URL}/familias`)
                ]);

                const doadores = doadoresResp.data.data;
                const produtos = produtosResp.data.data;
                const familias = familiasResp.data.data;

                if (!doadores.length) throw new Error('Cadastre doadores primeiro!');
                if (!produtos.length) throw new Error('Cadastre produtos primeiro!');
                if (!familias.length) throw new Error('Cadastre fam√≠lias primeiro!');

                const resultados = [];
                const numDoacoes = Math.min(5, doadores.length); // Criar at√© 5 doa√ß√µes

                for (let i = 0; i < numDoacoes; i++) {
                    try {
                        // Selecionar doador, produto e fam√≠lia aleat√≥rios
                        const doador = doadores[Math.floor(Math.random() * doadores.length)];
                        const produto = produtos[Math.floor(Math.random() * produtos.length)];
                        const familia = familias[Math.floor(Math.random() * familias.length)];

                        // Gerar data aleat√≥ria nos √∫ltimos 30 dias
                        const dataAleatoria = new Date();
                        dataAleatoria.setDate(dataAleatoria.getDate() - Math.floor(Math.random() * 30));

                        // Criar doa√ß√£o para fam√≠lia
                        const doacaoFamiliaData = {
                            familia_id_familia: familia.id,
                            produtos_id: produto.id,
                            quantidade: Math.floor(Math.random() * 5) + 1,
                            data: dataAleatoria.toISOString().slice(0, 10)
                        };

                        const response = await axios.post(`${API_BASE_URL}/doacao-familia`, doacaoFamiliaData, {
                            headers: {
                                'Content-Type': 'application/json',
                                'Accept': 'application/json'
                            }
                        });

                        resultados.push({
                            tipo: 'Fam√≠lia',
                            doador: doador.nome,
                            familia: familia.nome_representante,
                            produto: produto.nome,
                            sucesso: true,
                            dados: response.data
                        });

                    } catch (error) {
                        resultados.push({
                            tipo: 'Fam√≠lia',
                            sucesso: false,
                            erro: error.message
                        });
                    }
                }

                // Exibir resultados
                const sucessos = resultados.filter(r => r.sucesso).length;
                const falhas = resultados.length - sucessos;

                let html = `
                    <div class="success">
                        <h4>‚úÖ M√∫ltiplas doa√ß√µes criadas!</h4>
                        <p><strong>Total de tentativas:</strong> ${resultados.length}</p>
                        <p><strong>Sucessos:</strong> ${sucessos}</p>
                        <p><strong>Falhas:</strong> ${falhas}</p>
                        <p><strong>Doadores utilizados:</strong> ${doadores.length} dispon√≠veis</p>
                        <p><strong>Produtos utilizados:</strong> ${produtos.length} dispon√≠veis</p>
                        <p><strong>Fam√≠lias utilizadas:</strong> ${familias.length} dispon√≠veis</p>
                        <hr>
                        <h5>Detalhes das doa√ß√µes:</h5>
                `;

                resultados.forEach((resultado, index) => {
                    if (resultado.sucesso) {
                        html += `
                            <div style="margin: 10px 0; padding: 10px; background: #f0f8ff; border-left: 4px solid #28a745;">
                                <strong>Doa√ß√£o ${index + 1}:</strong> ${resultado.familia} recebeu ${resultado.produto}
                            </div>
                        `;
                    } else {
                        html += `
                            <div style="margin: 10px 0; padding: 10px; background: #fff3cd; border-left: 4px solid #ffc107;">
                                <strong>Doa√ß√£o ${index + 1}:</strong> Falhou - ${resultado.erro}
                            </div>
                        `;
                    }
                });

                html += '</div>';
                resultDiv.innerHTML = html;

            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao criar m√∫ltiplas doa√ß√µes</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Fun√ß√£o para criar m√∫ltiplos doadores de teste
        async function criarMultiplosDoadores() {
            const resultDiv = document.getElementById('doadores-result');
            resultDiv.innerHTML = '<p>Criando m√∫ltiplos doadores...</p>';
            
            // Lista de nomes brasileiros para gerar dados mais realistas
            const nomes = [
                "Ana Silva", "Carlos Santos", "Maria Oliveira", "Jo√£o Pereira", "Lucia Costa",
                "Pedro Ferreira", "Fernanda Lima", "Roberto Almeida", "Patricia Souza", "Marcos Rodrigues",
                "Juliana Barbosa", "Ricardo Gomes", "Camila Martins", "Andre Silva", "Vanessa Santos",
                "Felipe Oliveira", "Gabriela Costa", "Thiago Pereira", "Isabela Lima", "Rafael Almeida",
                "Carolina Souza", "Diego Rodrigues", "Amanda Barbosa", "Lucas Gomes", "Mariana Martins",
                "Bruno Silva", "Beatriz Santos", "Guilherme Oliveira", "Larissa Costa", "Matheus Pereira"
            ];
            
            const sobrenomes = [
                "Silva", "Santos", "Oliveira", "Souza", "Rodrigues", "Ferreira", "Almeida", "Pereira",
                "Lima", "Gomes", "Costa", "Ribeiro", "Martins", "Carvalho", "Alves", "Lopes", "Soares",
                "Fernandes", "Vieira", "Barbosa", "Rocha", "Dias", "Nascimento", "Andrade", "Moreira"
            ];
            
            const ruas = ["Rua das Flores", "Avenida Principal", "Rua do Com√©rcio", "Avenida Central", "Rua da Paz"];
            
            try {
                const resultados = [];
                const numDoadores = 10; // Criar 10 doadores

                for (let i = 0; i < numDoadores; i++) {
                    try {
                        // Gerar nome aleat√≥rio
                        const nomeAleatorio = nomes[Math.floor(Math.random() * nomes.length)];
                        const sobrenomeAleatorio = sobrenomes[Math.floor(Math.random() * sobrenomes.length)];
                        const nomeCompleto = `${nomeAleatorio} ${sobrenomeAleatorio}`;
                        
                        // Gerar endere√ßo aleat√≥rio
                        const numero = Math.floor(Math.random() * 999) + 1;
                        const ruaAleatoria = ruas[Math.floor(Math.random() * ruas.length)];

                        const doadorData = {
                            nome: nomeCompleto,
                            email: gerarEmailAleatorio(),
                            telefone: `(11) ${Math.floor(Math.random() * 90000) + 10000}-${Math.floor(Math.random() * 9000) + 1000}`,
                            endereco: `${ruaAleatoria}, ${numero}`
                        };

                        const response = await axios.post(`${API_BASE_URL}/doadores`, doadorData, {
                            headers: {
                                'Content-Type': 'application/json',
                                'Accept': 'application/json'
                            }
                        });

                        resultados.push({
                            nome: nomeCompleto,
                            sucesso: true,
                            dados: response.data
                        });

                    } catch (error) {
                        resultados.push({
                            nome: `Doador ${i + 1}`,
                            sucesso: false,
                            erro: error.message
                        });
                    }
                }

                // Exibir resultados
                const sucessos = resultados.filter(r => r.sucesso).length;
                const falhas = resultados.length - sucessos;

                let html = `
                    <div class="success">
                        <h4>‚úÖ M√∫ltiplos doadores criados!</h4>
                        <p><strong>Total de tentativas:</strong> ${resultados.length}</p>
                        <p><strong>Sucessos:</strong> ${sucessos}</p>
                        <p><strong>Falhas:</strong> ${falhas}</p>
                        <hr>
                        <h5>Doadores criados:</h5>
                `;

                resultados.forEach((resultado, index) => {
                    if (resultado.sucesso) {
                        html += `
                            <div style="margin: 10px 0; padding: 10px; background: #f0f8ff; border-left: 4px solid #28a745;">
                                <strong>Doador ${index + 1}:</strong> ${resultado.nome}
                            </div>
                        `;
                    } else {
                        html += `
                            <div style="margin: 10px 0; padding: 10px; background: #fff3cd; border-left: 4px solid #ffc107;">
                                <strong>Doador ${index + 1}:</strong> Falhou - ${resultado.erro}
                            </div>
                        `;
                    }
                });

                html += '</div>';
                resultDiv.innerHTML = html;

            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao criar m√∫ltiplos doadores</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Fun√ß√£o para criar m√∫ltiplas fam√≠lias de teste
        async function criarMultiplasFamilias() {
            const resultDiv = document.getElementById('familias-result');
            resultDiv.innerHTML = '<p>Criando m√∫ltiplas fam√≠lias...</p>';
            
            function gerarCpfAleatorio() {
                let cpf = '';
                for (let i = 0; i < 11; i++) {
                    cpf += Math.floor(Math.random() * 10);
                }
                return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4");
            }

            // Lista de nomes brasileiros para fam√≠lias
            const nomesFamilia = [
                "Maria Silva", "Jos√© Santos", "Ana Oliveira", "Carlos Pereira", "Lucia Costa",
                "Pedro Ferreira", "Fernanda Lima", "Roberto Almeida", "Patricia Souza", "Marcos Rodrigues",
                "Juliana Barbosa", "Ricardo Gomes", "Camila Martins", "Andre Silva", "Vanessa Santos",
                "Felipe Oliveira", "Gabriela Costa", "Thiago Pereira", "Isabela Lima", "Rafael Almeida",
                "Carolina Souza", "Diego Rodrigues", "Amanda Barbosa", "Lucas Gomes", "Mariana Martins",
                "Bruno Silva", "Beatriz Santos", "Guilherme Oliveira", "Larissa Costa", "Matheus Pereira"
            ];
            
            const sobrenomesFamilia = [
                "Silva", "Santos", "Oliveira", "Souza", "Rodrigues", "Ferreira", "Almeida", "Pereira",
                "Lima", "Gomes", "Costa", "Ribeiro", "Martins", "Carvalho", "Alves", "Lopes", "Soares",
                "Fernandes", "Vieira", "Barbosa", "Rocha", "Dias", "Nascimento", "Andrade", "Moreira"
            ];
            
            const ruas = ["Rua das Fam√≠lias", "Avenida da Esperan√ßa", "Rua da Solidariedade", "Avenida da Paz", "Rua da Uni√£o"];
            
            try {
                const resultados = [];
                const numFamilias = 8; // Criar 8 fam√≠lias

                for (let i = 0; i < numFamilias; i++) {
                    try {
                        // Gerar nome aleat√≥rio para fam√≠lia
                        const nomeAleatorio = nomesFamilia[Math.floor(Math.random() * nomesFamilia.length)];
                        const sobrenomeAleatorio = sobrenomesFamilia[Math.floor(Math.random() * sobrenomesFamilia.length)];
                        const nomeCompleto = `${nomeAleatorio} ${sobrenomeAleatorio}`;
                        
                        // Gerar endere√ßo aleat√≥rio
                        const numero = Math.floor(Math.random() * 999) + 1;
                        const ruaAleatoria = ruas[Math.floor(Math.random() * ruas.length)];

                        const familiaData = {
                            nome_representante: nomeCompleto,
                            cpf_responsavel: gerarCpfAleatorio(),
                            telefone: `(11) ${Math.floor(Math.random() * 90000) + 10000}-${Math.floor(Math.random() * 9000) + 1000}`,
                            endereco: `${ruaAleatoria}, ${numero}`
                        };

                        const response = await axios.post(`${API_BASE_URL}/familias`, familiaData, {
                            headers: {
                                'Content-Type': 'application/json',
                                'Accept': 'application/json'
                            }
                        });

                        resultados.push({
                            nome: nomeCompleto,
                            sucesso: true,
                            dados: response.data
                        });

                    } catch (error) {
                        resultados.push({
                            nome: `Fam√≠lia ${i + 1}`,
                            sucesso: false,
                            erro: error.message
                        });
                    }
                }

                // Exibir resultados
                const sucessos = resultados.filter(r => r.sucesso).length;
                const falhas = resultados.length - sucessos;

                let html = `
                    <div class="success">
                        <h4>‚úÖ M√∫ltiplas fam√≠lias criadas!</h4>
                        <p><strong>Total de tentativas:</strong> ${resultados.length}</p>
                        <p><strong>Sucessos:</strong> ${sucessos}</p>
                        <p><strong>Falhas:</strong> ${falhas}</p>
                        <hr>
                        <h5>Fam√≠lias criadas:</h5>
                `;

                resultados.forEach((resultado, index) => {
                    if (resultado.sucesso) {
                        html += `
                            <div style="margin: 10px 0; padding: 10px; background: #f0f8ff; border-left: 4px solid #28a745;">
                                <strong>Fam√≠lia ${index + 1}:</strong> ${resultado.nome}
                            </div>
                        `;
                    } else {
                        html += `
                            <div style="margin: 10px 0; padding: 10px; background: #fff3cd; border-left: 4px solid #ffc107;">
                                <strong>Fam√≠lia ${index + 1}:</strong> Falhou - ${resultado.erro}
                            </div>
                        `;
                    }
                });

                html += '</div>';
                resultDiv.innerHTML = html;

            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Erro ao criar m√∫ltiplas fam√≠lias</h4>
                        <p>${error.message}</p>
                        <pre>${JSON.stringify(error.response?.data || error, null, 2)}</pre>
                    </div>
                `;
            }
        }

        // Executar teste inicial quando a p√°gina carregar
        window.onload = function() {
            testarConexao();
        };
    </script>
</body>
</html> 